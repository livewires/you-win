<!doctype html>
<meta charset=utf-8>
<meta name=viewport content="width=device-width, initial-scale=1.0">
<title>you-win: #2: Animation</title>

<style>
body, div, p, textarea, pre, ul, ol, li, blockquote, hr,table, tbody, thead, tr, td, th,h1, h2, h3, h4, h5, a, button, input {margin: 0;padding: 0;border: 0;font: inherit;color: inherit;list-style: none;text-decoration: none;}strong {font-weight: 700;}em {font-style: italic;color: #555;}* {line-height: 1.5;}a {white-space: normal;cursor: pointer;}body {font-family: BlinkMacSystemFont, -apple-system, Helvetica Neue, Open Sans, Ubuntu, Arial, Helvetica, sans-serif;font-size: 1rem;background: #fff;color: #000;font-size: 16px;min-height: calc(100vh - 2em);}p {margin: 0.75em 0;}body {margin: 1.5em auto 6em;padding: 0 2em;max-width: 72em;position: relative;}.prose {font-size: 1rem;max-width: 32em;font-weight: normal;margin: 0 auto;}.prose a {color: #3786e3;text-decoration: none;border-bottom: 1px solid #3786e3;}.prose h1 {font-weight: 300;font-size: 2rem;}.prose h2 {font-weight: 500;font-size: 1.5em;margin: 1.333em 0 0;}.prose h3 {font-weight: 600;font-size: 1.25em;margin: 2em 0 0;}.prose pre, .prose code {border-radius: 0.25em;background: #f8f8f8;font-size: 0.8em;line-height: 1.5em;font-family: Menlo, monospace;}.prose pre {max-width: 100%;white-space: pre-wrap;margin: 1.09375em 0;overflow: hidden;padding: 0.25em 0.5em;}.prose code {padding: 0.125em;}.prose pre code {display: block;white-space: pre-wrap;border: none;padding: 0;background-color: transparent;border-radius: 0;font-size: inherit;line-height: inherit;}.prose > p {margin: 1.5em 0;}.prose > ul, .prose ol {margin: 1.5em 0;}.prose ul, .prose ol {padding-left: 1.875em;position: relative;}.prose ul > li {list-style: square;}.prose ol > li {list-style: none;counter-increment: step-count;}.prose ol > li:before {content: counter(step-count);font-weight: 500;display: inline-block;position: absolute;left: 0.5em;}.prose img,.prose video {max-width: 100%;object-fit: scale-down;height: auto;}@media print {body {max-width: 100%;font-size: 12pt;}.prose a {border-bottom: none;}.prose {margin: 0 auto;}nav {display: none;}pre, blockquote {padding-right: 1em;page-break-inside: avoid;}tr, img {page-break-inside: avoid;}@page {margin: 20mm 15mm 20mm 15mm;}p, h2, h3 {orphans: 3;widows: 3;}h2, h3 {page-break-after: avoid;}}nav {margin: -0.5em -2em;border-bottom: 1px solid #aaa;margin-bottom: 1.5em;}nav ul {padding: 0;margin: 0;}nav a {text-decoration: none;color: #364149;display: block;overflow: hidden;text-overflow: ellipsis;padding: 0.375em 2em;white-space: nowrap;}.title a {font-size: 2rem;padding: 0 1em;font-weight: 300;}.page {display: block;}.page-title-active {background: #3786e3;color: #fff;}.page-heading {display: block;padding-left: 1em;}@media screen and (min-width: 36rem) {body.has-nav {margin-left: 12rem;}nav {margin: 0;position: fixed;width: 12rem;left: 0;top: 0;bottom: 0;overflow-y: auto;font-size: 0.875em;border-right: 1px solid #aaa;background: #fafafa;border-bottom: 0;}nav a {padding: 0.375em 1em;}.title a {padding: 0.75em 0.5em 0.625em;}nav > ul {position: relative;min-height: 100vh;padding-bottom: 4.5em;box-sizing: border-box;}.page-as-pdf {position: absolute;bottom: 3em;}.logo {position: absolute;bottom: 1em;display: block;background: url("data:image/svg+xml,<svg viewBox='10 0 38 7' xmlns='http://www.w3.org/2000/svg'><path fill='%233786e3' d='M17 3h-1V1h1zM18 5h-1V3h1zM20 5h-1V3h1zM21 3h-1V1h1zM11 5h2v1h-3V1h1zM25 2h-2v1h2v1h-2v1h2v1h-3V1h3zM14 6V1h1v5zM18 5h1v1h-1z'/><path d='M42 2h-2v1h2v1h-2v1h2v1h-3V1h3zM30 5V1h1v4zM28 5V2h1v3zM32 6V1h1v5zM43 2h1v1h-1zM44 3h2v1h-2zM43 5h3v1h-3zM44 1h3v1h-3zM46 4h1v1h-1zM26 5V1h1v4zM27 5h1v1h-1zM29 5h1v1h-1zM34 6V1h3v1h-2v1h2v2h-1V4h-1v2zM37 5h1v1h-1zM37 2h1v1h-1z'/></svg>") 100% 0 no-repeat;margin: 0.5em 1em 0;height: 14px;width: 76px;}.logo span {display: none;}}.hljs { display: block; overflow-x: auto; padding: 0.5em; color: #333; background: #f8f8f8; } .hljs-comment, .hljs-quote { color: #998; font-style: italic; } .hljs-keyword, .hljs-selector-tag, .hljs-subst { color: #333; font-weight: bold; } .hljs-number, .hljs-literal, .hljs-variable, .hljs-template-variable, .hljs-tag .hljs-attr { color: #008080; } .hljs-string, .hljs-doctag { color: #d14; } .hljs-title, .hljs-section, .hljs-selector-id { color: #900; font-weight: bold; } .hljs-subst { font-weight: normal; } .hljs-type, .hljs-class .hljs-title { color: #458; font-weight: bold; } .hljs-tag, .hljs-name, .hljs-attribute { color: #000080; font-weight: normal; } .hljs-regexp, .hljs-link { color: #009926; } .hljs-symbol, .hljs-bullet { color: #990073; } .hljs-built_in, .hljs-builtin-name { color: #0086b3; } .hljs-meta { color: #999; font-weight: bold; } .hljs-deletion { background: #fdd; } .hljs-addition { background: #dfd; } .hljs-emphasis { font-style: italic; } .hljs-strong { font-weight: bold; }
</style>

<body class=has-nav>

<nav id=nav>
    <ul>
        <h1 class=title><a href="https://github.com/livewires/you-win">you-win</a></h1>

        <li class=page><a href="install">Install</a>
        <li class=page><a href="1-numbers">#1: Numbers</a>
        <li class=page>
            <a href="#" class=page-title-active>#2: Animation</a>
            <ul>
                <li class=page-heading><a href="#animation">Animation</a>
                <li class=page-heading><a href="#orientation">Orientation</a>
                <li class=page-heading><a href="#events">Events</a>
                <li class=page-heading><a href="#trig">Trig</a>
                <li class=page-heading><a href="#conditions">Conditions</a>
                <li class=page-heading><a href="#fin">Fin</a>
                <li class=page-heading><a href="#what-next-">What next?</a>
            </ul>
        </li>
        <li class=page><a href="3-arrays">#3: Arrays</a>
        <li class=page><a href="4-functions">#4: Functions</a>
        <li class=page><a href="jump">Game: Infinite Jump!</a>
        <li class=page><a href="reference">API Reference</a>

        <a class=page-as-pdf href="pdfs/2-animation.pdf">Page as PDF ‚Üì</a>
        <a class=logo href="http://livewires.org.uk/"></a>
    </ul>
</nav>

<div class=prose>
<h1 id="intro-2-animation">Intro #2: Animation</h1>
<h2 id="animation">Animation</h2>
<p>So far, we‚Äôve only set up static scenes. We‚Äôve learnt how to position different kinds of objects on the screen, and change how they look; but we haven‚Äôt moved them or changed them after initialisation.</p>
<p><strong>Animation</strong> means to give an appearance of movement. We do this by <strong>changing values over time</strong>.</p>
<ul>
<li><p>First, start a <strong>new project</strong>, and make a Sprite with your favourite emoji.</p>
<pre><code class="lang-js">var face = new Sprite
face.costume = &#39;üêÆ&#39;
</code></pre>
</li>
</ul>
<h3 id="forever">Forever</h3>
<p>We need a way to react to time passing. We do this by using <strong><code>forever</code></strong> to run code on every <em>frame</em>.</p>
<pre><code class="lang-js">forever(() =&gt; {
    // do stuff
})
</code></pre>
<p>An app draws a new frame on the screen roughly 60 times a second (or 60 <strong>FPS</strong>, frames per second).</p>
<p>We can use <code>forever</code> to make our sprite spin!</p>
<ul>
<li><p>Add a <code>forever</code> block, right after you create your <code>Sprite</code>.</p>
<p><s></p>
<pre><code class="lang-js">face.angle += 1
</code></pre>
<p></s>
<em>Delete this.</em></p>
<pre><code class="lang-js">face.angle += 1
</code></pre>
<p><em>Add this, <strong>inside</strong> the <code>forever</code>.</em></p>
</li>
</ul>
<p>In JavaScript, <code>x += 1</code> is shorthand for <code>x = x + 1</code>. You can read it as <strong>‚Äúchange by‚Äù</strong>.</p>
<p>By increasing the angle of the sprite on every frame, our sprite will slowly rotate clockwise.</p>
<ul>
<li><strong>Challenge:</strong> make the sprite rotate anticlockwise.</li>
</ul>
<p>Now we know the basics of animation, lets try some simple movement.</p>
<ul>
<li><p><strong>Instead</strong> of rotating, move the Sprite right.</p>
<p><s></p>
<pre><code class="lang-js">face.angle += 1
</code></pre>
<p></s></p>
<pre><code class="lang-js">face.x += 2
</code></pre>
</li>
</ul>
<p>You can make the sprite move faster by increasing the number <code>2</code>, since the sprite will move further on each frame.</p>
<ul>
<li><p><strong>Challenge</strong>: experiment with animating other properties, like gradually increasing scale:</p>
<pre><code class="lang-js">    face.scale *= 1.05
</code></pre>
</li>
</ul>
<h2 id="orientation">Orientation</h2>
<p>We can read the phone‚Äôs accelerometer to get the angle the phone‚Äôs being held at, compared to gravity.</p>
<p>First, we need to initialise a <code>Phone</code> object, so that <code>you-win</code> knows to start reading the phone‚Äôs orientation sensors.</p>
<ul>
<li><p>Put this near the top of your program, after the <code>import</code> lines.</p>
<p>You might find a commented out-line already, in which case just uncomment it!</p>
<p><s></p>
<pre><code class="lang-js">// var phone = new Phone
</code></pre>
<p></s></p>
<pre><code class="lang-js">var phone = new Phone
</code></pre>
</li>
<li><p>Rotate the sprite when the phone rotates.</p>
<p><s></p>
<pre><code class="lang-js">forever(() =&gt; {
    // whatever you had before
})
</code></pre>
<p></s></p>
<pre><code class="lang-js">forever(() =&gt; {
    face.angle = phone.zAngle
})
</code></pre>
</li>
<li><p><strong>Challenge</strong>: what happens if you use negative <code>zAngle</code>?</p>
<p>(This might not make sense, depending on whether you‚Äôre using an iPhone. THe idea is that the face always stays upright while you rotate the phone! Feel free to skip this if it doesn‚Äôt make sense.)</p>
</li>
</ul>
<h2 id="events">Events</h2>
<p>Let‚Äôs have our face shoot out a projectile toward our finger when we tap.</p>
<ul>
<li><p>Delete (or comment out) the <code>forever</code> block for now ‚Äì we won‚Äôt need it until later.</p>
<p><s></p>
<pre><code class="lang-js">forever(() =&gt; {
    face.angle = phone.zAngle
})
</code></pre>
<p></s></p>
</li>
<li><p>Use <code>on(&#39;tap&#39;)</code> to detect when the screen is tapped.</p>
<pre><code class="lang-js">world.on(&#39;tap&#39;, e =&gt; {
    alert(&quot;dont touch this&quot;)
})
</code></pre>
</li>
</ul>
<p>The code inside the <code>on(...</code> block runs whenever the screen is tapped.  So whenever you tap (or click) the screen, the message ‚Äúdon‚Äôt touch this‚Äù should appear.</p>
<p>That gets boring quickly, so let‚Äôs make a projectile.</p>
<ul>
<li><p>When the screen is tapped, make a bullet under your finger.</p>
<p><s></p>
<pre><code class="lang-js">    alert(&quot;dont touch this&quot;)
</code></pre>
<p></s></p>
<pre><code class="lang-js">world.on(&#39;tap&#39;, e =&gt; {
    var bullet = new Sprite
    bullet.costume = &#39;üëæ&#39;
    bullet.x = e.fingerX
    bullet.y = e.fingerY

    // TODO: move the bullet ...
})
</code></pre>
<p><em>Add this <strong>inside</strong> the <code>world.on(&#39;tap&#39;...</code> block.</em></p>
</li>
</ul>
<p>What‚Äôs going on here? <code>e</code> is an <strong>event</strong> object, telling us the details of the <strong>tap</strong> event. The <code>e.fingerX</code> and <code>e.fingerY</code> attributes tell us the coordinates of the tap.</p>
<p>Now let‚Äôs try moving our projectile!</p>
<ul>
<li><p>Add a <code>forever</code> block to move the Sprite we created after the tap.</p>
<pre><code class="lang-js">world.on(&#39;tap&#39;, e =&gt; {
    // ... [make the bullet] ...

    forever(() =&gt; {
        bullet.x += 3
        bullet.y += 3
    })
})
</code></pre>
</li>
</ul>
<p>Since the <code>forever</code> block is inside the <code>on</code>, it too runs on every <code>tap</code>; and the <code>bullet</code> variable that it refers to is the one we just created. (This phenomenon is called ‚Äúscope‚Äù; more about that in <a href="4-Functions.md">Intro #4: Functions</a>.</p>
<h2 id="trig">Trig</h2>
<p>Sometimes we want to move things at an angle‚Äìand to do this, we need <strong>trigonometry</strong>!</p>
<p>It‚Äôd be really neat if our bullets started at the face, and travelled outward toward the point where we tapped. Then it would feel more like a ‚Äúcannon‚Äù sort-of game.</p>
<ul>
<li><p><strong>Challenge</strong>: make the bullets start at the same position as the <code>face</code>.</p>
<p><em>Make sure you do this! If you don‚Äôt, then the bullets won‚Äôt move in the right direction later :-)</em></p>
</li>
</ul>
<p>I‚Äôm not going to explain all of trig here, since that would be boring. For the purposes, we only need to know two things:</p>
<ol>
<li>You can use <code>.x += UW.sin(angle)</code> and <code>.y += UW.cos(angle)</code> to move a sprite at an angle.</li>
<li>You can use <code>angle = UW.atan2(dx, dy)</code> to work out the angle you need to move something in a direction.</li>
</ol>
<p>Currently, our bullets all go at 45¬∞, which is dull. Let‚Äôs fire them out at a random angle.</p>
<ul>
<li><p><strong>Challenge</strong>: create the bullets with a random initial direction.</p>
<p><em>Hint: you want to set their <code>angle</code> to a random number between <code>1</code> and <code>360</code>.</em></p>
</li>
<li><p>Now move them at that angle by replacing your <code>forever</code> block.</p>
<pre><code class="lang-js">world.on(&#39;tap&#39;, e =&gt; {
    // ... [make the bullet, with random angle] ...

    forever(() =&gt; {
        bullet.x += 4 * UW.sin(bullet.angle)
        bullet.y += 4 * UW.cos(bullet.angle)
    })
})
</code></pre>
</li>
</ul>
<p>By multiplying <code>sin</code> and <code>cos</code> by 4, we increase the speed of movement.</p>
<p>So we‚Äôve done the first part ‚Äì moving the bullets in a direction.</p>
<p>Now to work out the correct angle! We need to use <code>atan2</code> for this. This is a special version of inverse <em>tan()</em> which takes two numbers‚Äìa difference in <code>x</code> and a difference in <code>y</code>‚Äìand returns the correct angle.</p>
<ul>
<li><p>Use <code>atan2</code> to get the correct angle.</p>
<pre><code class="lang-js">world.on(&#39;tap&#39;, e =&gt; {
    var bullet = new Sprite
    // ... [go to face] ...
    bullet.angle = UW.atan2(e.fingerX - face.x, e.fingerY - face.y)

    // ... [move at an angle] ...
})
</code></pre>
</li>
</ul>
<p>Congrats! We‚Äôve just made a‚Ä¶ face-cannon‚Ä¶ thing.</p>
<h2 id="conditions">Conditions</h2>
<p>Animation is all very well, and we‚Äôve learnt how to react to <em>events</em>. But how can we react to other things changing?</p>
<p>A <strong>condition</strong> is an expression that‚Äôs either <code>true</code> or <code>false</code>. They look like this:</p>
<ol>
<li><code>x === y</code> means <em>x is equal to y</em></li>
<li><code>x !== y</code> means <em>x is not equal to y</em></li>
<li><code>x &lt; y</code> means <em>x is less than y</em></li>
<li><code>x &lt;= y</code> means <em>x is less than or equal to y</em></li>
<li><code>!p</code> means <strong>not</strong> <em><code>true</code> if p is <code>false</code>, and vice-versa</em></li>
<li><code>p &amp;&amp; q</code> means <strong>and</strong> <em><code>true</code> only if both p and q are <code>true</code></em></li>
<li><code>p || q</code> means <strong>or</strong> <em><code>true</code> if either of p or q is <code>true</code></em></li>
</ol>
<p>Here are some examples. These are all <code>true</code>:</p>
<ol>
<li><code>1 !== 2</code></li>
<li><code>42 === 42</code></li>
<li><code>&quot;moo&quot; === &quot;moo&quot;</code></li>
<li><code>10 &lt; 42</code></li>
<li><code>!(false)</code></li>
<li><code>true &amp;&amp; true</code></li>
<li><code>false || true</code></li>
</ol>
<p>Finally, there‚Äôs a really important condition built-in to moo. It‚Äôs a function attached to a Sprite, and it‚Äôs called <code>.isTouching(otherSprite)</code>. More about that later!</p>
<p>Let‚Äôs see what we can do with conditions.</p>
<ul>
<li><p>First, make our cannon-face move.</p>
<pre><code class="lang-js">var xVel = 2

forever(() =&gt; {
    face.x += xVel
})
</code></pre>
</li>
</ul>
<p>This time, we‚Äôre using a variable to store its speed. We‚Äôll need this to be a variable so we can change it later.</p>
<p>Just as you can store objects (such as <code>Sprite</code>s) in a variable, you can store a number in a variable to ‚Äúremember‚Äù it for later. You can change it later, too.</p>
<p>We‚Äôre moving him to the right (increasing x).</p>
<ul>
<li><p>Now, let‚Äôs have it bounce off the right edge.</p>
<pre><code class="lang-js">forever(() =&gt; {
    face.x += xVel
    if (world.width &lt; face.right) {
        xVel = -2
    }
})
</code></pre>
</li>
</ul>
<p>We do this by comparing his <code>right</code> edge to the width of the world. If his right edge is greater than the width of the world, then he‚Äôs gone off the right-hand side of the screen; so we set his velocity negative, so he starts moving left instead.</p>
<ul>
<li><p>Flip the costume, for good measure‚Ä¶</p>
<pre><code class="lang-js">    // ...
    face.flipped = !face.flipped
</code></pre>
</li>
<li><p><strong>Challenge:</strong> make it bounce off the left edge too.</p>
<p>You‚Äôll need to add a second <code>if</code> block.</p>
<p>Hint: the left-hand side of the world is where <code>x = 0</code>‚Ä¶</p>
</li>
<li><p>Check that the bullets still come from the face, and head toward your finger!</p>
</li>
</ul>
<p>Finally, if we don‚Äôt destroy the bullets, eventually the game will get really slow! Let‚Äôs fix that, by destroying them once they‚Äôre completely off the screen:</p>
<ul>
<li><p>Destroy the bullets once they‚Äôre completely off-screen.</p>
<p><strong>Challenge</strong>: where should this go?</p>
<pre><code class="lang-js">    if (!bullet.isOnScreen()) {
        bullet.destroy()
    }
</code></pre>
<p><em>This should go inside the bullet‚Äôs <code>forever</code>, just after the code to move it.</em></p>
</li>
</ul>
<p>The <code>destroy()</code> function attached to a Sprite removes it from the screen permanently.</p>
<p>However, we haven‚Äôt quite cleaned up after ourselves‚Äìthe forever block for the bullet will keep running, even though it‚Äôs no longer on screen! This isn‚Äôt super-important, but in larger games it might cause us to run out of memory. So let‚Äôs <code>return false</code> to stop the <code>forever</code> block from running:</p>
<ul>
<li><p>We should also <code>return false</code>, to make sure the <code>forever</code> block stops.</p>
<pre><code class="lang-js">    if (!bullet.isOnScreen()) {
        bullet.destroy()
        return false // stop this forever block
    }
</code></pre>
</li>
</ul>
<h2 id="fin">Fin</h2>
<p>Excellent work! You‚Äôve learnt how to:</p>
<ul>
<li>do something over time with <strong><code>forever</code></strong></li>
<li><strong>Change attributes</strong> using <code>+=</code></li>
<li><em>Move</em> things over time (<strong>animation</strong>!)</li>
<li>React to the <strong>orientation</strong> of the phone</li>
<li>How to <strong>detect taps</strong> using <code>.on(&#39;tap&#39;, e =&gt; { ... })</code></li>
<li>How to move things at an <strong>angle</strong></li>
<li>Using <code>if</code> for <strong>conditions</strong></li>
<li><code>destroy</code>-ing Sprites when you‚Äôre finished with them</li>
</ul>
<h2 id="what-next-">What next?</h2>
<p>If you want something else to try, here are some extensions to try! Why not:</p>
<ul>
<li><p>Carry on moving the bullets at an angle, but have their picture stay upright.</p>
<p><em>Hint: you‚Äôll need a <code>var</code> statement for this‚Äìbut make sure you get it in the right place!</em></p>
<p><em>Hint #2: the relevant phenomenon here is called ‚Äúscope‚Äù, and it‚Äôs hard to understand, so ask someone to explain it to you!</em></p>
</li>
<li><p>Generally have a play around with the thing you just made, or more generally, everything you‚Äôve learnt in chapters 1 and 2.</p>
<p>Come back when you‚Äôre ready for the <a href="Jump">next thing</a> üôÉ</p>
</li>
</ul>

</div>

<script async id=highlight-js src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>
document.querySelector('#highlight-js').addEventListener('load', function() {
    [].slice.apply(document.querySelectorAll('pre code')).forEach(function(b) {
        hljs.highlightBlock(b)
    })
})
</script>

